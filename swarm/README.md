# Docker Clustering (Swarm)

Тестовое окружение для создания кластера из нод, размещенных в разных датацентрах.
Текущая конфигурация:

KV-хранилище информации кластера, мастер-нода и 1 рабочая нода в Vscale
1 рабочая нода у DigitalOcean

## Install

Для установки потребуютяс переменные окружения:
`VSCALE_ACCESS_TOKEN` - токен доступа к API Vscale
`DIGITALOCEAN_ACCESS_TOKEN` - токен доступа к API DigitalOcean

`$> ./init.sh`

Скрипт создаст все машины и объединит их в кластера

## Usage

Для запуска тестового приложения необходимо запустить в консоли:

`$> docker-compose --x-networking --project-name=counter up -d`

На нужных нодах будут получены необходимые образы и запущено приложение.
База данных запустится на `swarm-node-02`, а веб-приложение на `swarm-node-01`

Для проверки работы приложения достаточно зайти в браузере на публичный IP адрес master-ноды на 80 порт.
Если все настроено верно и кластер в рабочем состоянии, то Вы увидите счетчик посещений.

## Cleaning
Для удаления всего кластера достаточно запустить скрипт

`$> ./clean.sh`
который удалит все ноды кластера безвозвратно.
